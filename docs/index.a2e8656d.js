function e(e,t,n,o){Object.defineProperty(e,t,{get:n,set:o,enumerable:!0,configurable:!0})}function t(e){return e&&e.__esModule?e.default:e}var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},o={},a={},r=n.parcelRequire3a97;null==r&&((r=function(e){if(e in o)return o[e].exports;if(e in a){var t=a[e];delete a[e];var n={id:e,exports:{}};return o[e]=n,t.call(n.exports,n,n.exports),n.exports}var r=new Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}).register=function(e,t){a[e]=t},n.parcelRequire3a97=r),r.register("27Lyk",(function(t,n){var o,a;e(t.exports,"register",(()=>o),(e=>o=e)),e(t.exports,"resolve",(()=>a),(e=>a=e));var r={};o=function(e){for(var t=Object.keys(e),n=0;n<t.length;n++)r[t[n]]=e[t[n]]},a=function(e){var t=r[e];if(null==t)throw new Error("Could not resolve bundle with id "+e);return t}})),r("27Lyk").register(JSON.parse('{"ff4VL":"index.a2e8656d.js","5FqY5":"img0.0209cc49.jpg","2MmLe":"img1.a33b6e0d.jpg","3CFfE":"img2.3de99596.jpg"}'));const s=e=>{localStorage.setItem("user",e)},l=async()=>{localStorage.removeItem("user")},c=async()=>await p(localStorage.getItem("user")+""),i=async({header:e,method:t,body:n,json:o=!0})=>{const a={headers:{Accept:"application/json","Content-type":"application/json"},body:n&&JSON.stringify(n),method:t},r=await fetch(`https://thesocialapp-62205-default-rtdb.europe-west1.firebasedatabase.app/${e}.json`,a);if(!r.ok)throw alert("API failed to fetch");if(o)return await r.json()},d=async e=>{const t=await m(),n=Object.values(t);return Object.getOwnPropertyNames(t).filter(((t,o)=>{if(n[o].email===e.email)return t}))},u=async(e,t)=>{const n=await(async e=>(await p(e.email)).posts)(e),o=null!=n?n:[];return o.push(t),e.posts=o,console.log(await d(e)),i({header:`users/${await d(e)}`,method:"PATCH",body:e,json:!0})},m=async()=>await i({header:"users",method:"GET",body:null,json:!0}),p=async e=>{const t=await m();return Object.values(t).filter((t=>t.email===e))[0]},f=async e=>{const t=await m();if(null!==t){if(Object.values(t).find((t=>t.email===e.email||t.username===e.username)))return alert("Email or username already exists")}return s(e.email),window.location.href="../index.html",i({header:"users",method:"POST",body:e,json:!0})},g=async e=>i({header:`users/${await d(e)}`,method:"DELETE",body:null,json:!0}),h=async(e,t)=>{const n=await m(),o=Object.values(n).filter((t=>{if(t.email===e.email&&t.password===e.password)return t}));if(0!==o.length)return console.log("login",o[0]),s(e.email),t&&(window.location.href="../index.html"),e;alert("User not found")};var y={};y=new URL(r("27Lyk").resolve("5FqY5"),import.meta.url).toString();var v={};v=new URL(r("27Lyk").resolve("2MmLe"),import.meta.url).toString();var w={};let E;w=new URL(r("27Lyk").resolve("3CFfE"),import.meta.url).toString();const b=document.querySelector(".registerUser"),L=document.querySelector(".signinUser");null!=b&&b.addEventListener("click",(async e=>{e.preventDefault(),e.stopPropagation(),await f(N(!0))})),null!=L&&L.addEventListener("click",(async e=>{e.preventDefault(),e.stopPropagation(),E=await h(N(!1),!0),null!==E&&C()}));const S=document.querySelector(".container");document.querySelector("main");function x(e){let n;switch(e){case"img0":n=t(y);break;case"img1":n=t(v);break;case"img2":n=t(w)}return n}function j(e){S.innerHTML="<div></div>";let t=document.createElement("div");const n=document.createElement("h1");n.style.textAlign="center",n.innerText=e.username,t.append(n);const o=document.createElement("img");o.className="userImage",o.src=x(e.img),t.append(o),S.append(t),t.className="postContainer";const a=e.posts;null!=a&&a.forEach((e=>{let n=document.createElement("div");n.className="postFrame";let o=document.createElement("p");o.innerText=e.text,n.append(o),t.append(n)}))}null==E&&async function(){let e=await c();null!=e&&localStorage.getItem("user")&&(E=await h(e,!1),null!==E&&C())}();const k=document.querySelector("#close-post"),q=document.querySelector("#postBox");function N(e){const t=document.querySelector(".email"),n=document.querySelector(".username"),o=document.querySelector(".password");var a=document.querySelector("input:checked");const r={email:t.value,password:o.value};if(e){r.username=n.value;var s;s=a.classList[0],alert(s),r.img=s}return r}q.classList.add("hide"),k.addEventListener("click",(()=>{q.classList.add("hide")})),async function(){const e=await m(),t=Object.values(e).sort(((e,t)=>e.posts&&t.posts?t.posts.length-e.posts.length:e.posts?-1:t.posts?1:0));t.forEach(((e,t)=>{const n=document.createElement("div"),o=document.createElement("div");o.className="postLayout card"+t;const a=document.createElement("img");a.className="userProfile card"+t,a.src=x(e.img),console.log(a.src),o?.append(a),n.className="postCard card"+t;const r=document.createElement("h3");r.className="post card"+t,r.innerText=e.username,o.append(r);const s=document.createElement("h4");s.className="postAmount card"+t,null==e.posts?s.innerText="Posts: none":(s.innerText="Posts: "+e.posts.length,e.posts.reverse()),o.append(s),n.append(o),S?.append(n)})),null!==S&&S.addEventListener("click",(async e=>{e.preventDefault(),e.stopPropagation();const n=e.target;t.forEach(((e,t)=>{n.classList.contains("card"+t)&&j(e)}))}))}();let T=document.querySelector(".upload");async function C(){let e=document.querySelector(".signinBtn"),t=document.querySelector(".btns"),n=document.createElement("select"),o=document.createElement("option"),a=document.createTextNode(E.username);o.appendChild(a);let r=document.createElement("option"),s=document.createTextNode("Logout");r.appendChild(s);let c=document.createElement("option"),i=document.createTextNode("Delete");c.appendChild(i),n.appendChild(o),n.appendChild(r),n.appendChild(c),t?.appendChild(n),console.log("he"),e?.remove(),T?.classList.add("show"),r.addEventListener("click",(function(o){n.remove(),console.log("Logging out..."),t?.append(e),T?.remove(),window.location.href="../index.html",l()})),c.addEventListener("click",(async function(e){e.preventDefault(),await g(E).then((e=>window.location.href="../index.html"))})),null!=E.posts&&(E.posts.reverse(),o.addEventListener("click",(function(e){j(E)})))}const O=document.querySelector("#submit-button"),_=document.querySelector("#post-text");O.addEventListener("click",(async()=>{console.log(_.value),await u(E,{text:_.value}),window.location.href="../index.html"})),T?.addEventListener("click",(e=>{q.classList.remove("hide")}));
//# sourceMappingURL=index.a2e8656d.js.map
